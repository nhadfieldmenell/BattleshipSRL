% 4x4 board
% 2 boats of length 2
% 1-indexed

size(first, 2).
size(second, 2).
boat(first).
boat(second).

0.5::horizontal(B); 0.5::vertical(B) :- boat(B).
%occupied(A, Row, Col); occupied(B, Row, Col) :- boat(A), boat(B), boat_in(Row, Col).

double_stacked :- boat(B), boat(C), not(B = C), between(1, 4, Row), between(1, 4, Col), occupied(B, Row, Col), occupied(C, Row, Col).

% there are boardsize * (boardsize + 1 - L) equally likely positions to place a horizontal boat of length L (same for vertical)
1/12::loc(B, Row, Col) :-  boat(B), between(1, 4, Row), between(1, 3, Col), horizontal(B), size(B, 2).
1/12::loc(B, Row, Col) :-  boat(B), between(1, 3, Row), between(1, 4, Col), vertical(B), size(B, 2).


occupied(B, Row, Col) :- boat(B), horizontal(B), loc(B, Row, Z), size(B, L), Col-Z < L, Col-Z >= 0, Row > 0, Col > 0.
occupied(B, Row, Col) :- boat(B), vertical(B), loc(B, Z, Col), size(B, L), Row-Z < L, Row-Z >= 0, Row > 0, Col > 0.

boat_in(Row, Col) :- boat(B), occupied(B, Row, Col).

% do not need to worry about board size here, because we will only be given valid unoccupied evidence
not(loc(B, Row, Z)) :- boat(B), horizontal(B), not(occupied(B, Row, Col)), length(B, L), Col-Z < L, Col-Z >= 0.
not(loc(B, Z, Col)) :- boat(B), vertical(B), not(occupied(B, Row, Col)), length(B, L), Row-Z < L, Row-Z >= 0.



evidence(not(double_stacked)).



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%TESTING%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

evidence(boat_in(1,2)).
evidence(boat_in(2,1)).


query(boat_in(1,1)).
query(boat_in(1,3)).
query(occupied(second, 1, 1)).
query(occupied(first,1,1)).

%query(occupied(first,1,2)).
%query(occupied(second,1,2)).

%query(loc(second, 1,1)).
%query(loc(second,1,2)).

%query(occupied(first,1,1)).
%query(occupied(second,1,1)).
%query(boat_in(1,2)).
%query(boat_in(1,3)).
%query(boat_in(1,4)).
%query(boat_in(2,1)).
%query(boat_in(2,2)).
%query(boat_in(2,3)).
%query(boat_in(2,4)).
%query(boat_in(3,1)).
%query(boat_in(3,2)).
%query(boat_in(3,3)).
%query(boat_in(3,4)).
%query(boat_in(4,4)).
%query(boat_in(4,1)).
%query(boat_in(4,2)).
%query(boat_in(4,3)).
%query(boat_in(4,4)).
%query(loc(first, 2,2)).